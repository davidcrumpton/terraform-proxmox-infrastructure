# $OpenBSD: ypldap.conf,v 1.1 2014/07/11 21:20:10 deraadt Exp $
# {{ ansible_managed }}
# SPDX-License-Identifier: MIT

domain		"{{ domainname }}"
interval	60
provide map	"passwd.byname"
provide map	"passwd.byuid"
provide map	"group.byname"
provide map	"group.bygid"
provide map	"netid.byname"
# cafile		"{{ paths.eaglecreek_crt }}"

directory "{{ ldap.service.hostname }}" port {{ ldap.service.port }} {{ ldap.service.schema }} {
	# directory options
	#binddn "cn=admin,dc=example,dc=com"
	#bindcred "secret"
	basedn "{{ ldap.service.basedn }}"
	# starting point for groups directory search, default to basedn
	#groupdn "ou=Groups,dc=example,dc=com"

	# passwd maps configuration (RFC 2307 posixAccount object class)
	passwd filter "(objectClass=posixAccount)"

	attribute name maps to "uid"
	fixed attribute passwd "*"
	attribute uid maps to "uidNumber"
	attribute gid maps to "gidNumber"
	attribute gecos maps to "cn"
	attribute home maps to "homeDirectory"
	attribute shell maps to "loginShell"
	fixed attribute change "0"
	fixed attribute expire "0"
	fixed attribute class "ldap"

	# group maps configuration (RFC 2307 posixGroup object class)
	group filter "(objectClass=posixGroup)"

	attribute groupname maps to "cn"
	fixed attribute grouppasswd "*"
	attribute groupgid maps to "gidNumber"
	# memberUid returns multiple group members
	list groupmembers maps to "memberUid"
}
